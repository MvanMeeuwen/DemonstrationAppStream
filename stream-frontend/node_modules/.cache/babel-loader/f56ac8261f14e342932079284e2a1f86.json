{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.excelSheetFromDataSet = exports.excelSheetFromAoA = exports.dateToNumber = exports.strToArrBuffer = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nvar _tempaXlsx = require('tempa-xlsx');\n\nvar _tempaXlsx2 = _interopRequireDefault(_tempaXlsx);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar strToArrBuffer = function strToArrBuffer(s) {\n  var buf = new ArrayBuffer(s.length);\n  var view = new Uint8Array(buf);\n\n  for (var i = 0; i != s.length; ++i) {\n    view[i] = s.charCodeAt(i) & 0xFF;\n  }\n\n  return buf;\n};\n\nvar dateToNumber = function dateToNumber(v, date1904) {\n  if (date1904) {\n    v += 1462;\n  }\n\n  var epoch = Date.parse(v);\n  return (epoch - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n};\n\nvar excelSheetFromDataSet = function excelSheetFromDataSet(dataSet) {\n  /*\n  Assuming the structure of dataset\n  {\n      xSteps?: number; //How many cells to skips from left\n      ySteps?: number; //How many rows to skips from last data\n      columns: [array | string]\n      data: [array_of_array | string|boolean|number | CellObject]\n      fill, font, numFmt, alignment, and border\n  }\n   */\n  if (dataSet === undefined || dataSet.length === 0) {\n    return {};\n  }\n\n  var ws = {};\n  var range = {\n    s: {\n      c: 10000000,\n      r: 10000000\n    },\n    e: {\n      c: 0,\n      r: 0\n    }\n  };\n  var rowCount = 0;\n  dataSet.forEach(function (dataSetItem) {\n    var columns = dataSetItem.columns;\n    var xSteps = typeof dataSetItem.xSteps === 'number' ? dataSetItem.xSteps : 0;\n    var ySteps = typeof dataSetItem.ySteps === 'number' ? dataSetItem.ySteps : 0;\n    var data = dataSetItem.data;\n\n    if (dataSet === undefined || dataSet.length === 0) {\n      return;\n    }\n\n    rowCount += ySteps;\n    var columnsWidth = [];\n\n    if (columns.length >= 0) {\n      columns.forEach(function (col, index) {\n        var cellRef = _tempaXlsx2.default.utils.encode_cell({\n          c: xSteps + index,\n          r: rowCount\n        });\n\n        fixRange(range, 0, 0, rowCount, xSteps, ySteps);\n        var colTitle = col;\n\n        if ((typeof col === 'undefined' ? 'undefined' : _typeof(col)) === 'object') {\n          //colTitle = col.title; //moved to getHeaderCell\n          columnsWidth.push(col.width || {\n            wpx: 80\n          });\n          /* wch (chars), wpx (pixels) - e.g. [{wch:6},{wpx:50}] */\n        }\n\n        getHeaderCell(colTitle, cellRef, ws);\n      });\n      rowCount += 1;\n    }\n\n    if (columnsWidth.length > 0) {\n      ws['!cols'] = columnsWidth;\n    }\n\n    for (var R = 0; R != data.length; ++R, rowCount++) {\n      for (var C = 0; C != data[R].length; ++C) {\n        var cellRef = _tempaXlsx2.default.utils.encode_cell({\n          c: C + xSteps,\n          r: rowCount\n        });\n\n        fixRange(range, R, C, rowCount, xSteps, ySteps);\n        getCell(data[R][C], cellRef, ws);\n      }\n    }\n  });\n\n  if (range.s.c < 10000000) {\n    ws['!ref'] = _tempaXlsx2.default.utils.encode_range(range);\n  }\n\n  return ws;\n};\n\nfunction getHeaderCell(v, cellRef, ws) {\n  var cell = {};\n  var headerCellStyle = v.style ? v.style : {\n    font: {\n      bold: true\n    }\n  }; //if style is then use it\n\n  cell.v = v.title;\n  cell.t = 's';\n  cell.s = headerCellStyle;\n  ws[cellRef] = cell;\n}\n\nfunction getCell(v, cellRef, ws) {\n  //assume v is indeed the value. for other cases (object, date...) it will be overriden.\n  var cell = {\n    v: v\n  };\n\n  if (v === null) {\n    return;\n  }\n\n  var isDate = v instanceof Date;\n\n  if (!isDate && (typeof v === 'undefined' ? 'undefined' : _typeof(v)) === 'object') {\n    cell.s = v.style;\n    cell.v = v.value;\n    v = v.value;\n  }\n\n  if (typeof v === 'number') {\n    cell.t = 'n';\n  } else if (typeof v === 'boolean') {\n    cell.t = 'b';\n  } else if (isDate) {\n    cell.t = 'n';\n    cell.z = _tempaXlsx2.default.SSF._table[14];\n    cell.v = dateToNumber(cell.v);\n  } else {\n    cell.t = 's';\n  }\n\n  ws[cellRef] = cell;\n}\n\nfunction fixRange(range, R, C, rowCount, xSteps, ySteps) {\n  if (range.s.r > R + rowCount) {\n    range.s.r = R + rowCount;\n  }\n\n  if (range.s.c > C + xSteps) {\n    range.s.c = C + xSteps;\n  }\n\n  if (range.e.r < R + rowCount) {\n    range.e.r = R + rowCount;\n  }\n\n  if (range.e.c < C + xSteps) {\n    range.e.c = C + xSteps;\n  }\n}\n\nvar excelSheetFromAoA = function excelSheetFromAoA(data) {\n  var ws = {};\n  var range = {\n    s: {\n      c: 10000000,\n      r: 10000000\n    },\n    e: {\n      c: 0,\n      r: 0\n    }\n  };\n\n  for (var R = 0; R != data.length; ++R) {\n    for (var C = 0; C != data[R].length; ++C) {\n      if (range.s.r > R) {\n        range.s.r = R;\n      }\n\n      if (range.s.c > C) {\n        range.s.c = C;\n      }\n\n      if (range.e.r < R) {\n        range.e.r = R;\n      }\n\n      if (range.e.c < C) {\n        range.e.c = C;\n      }\n\n      var cell = {\n        v: data[R][C]\n      };\n\n      if (cell.v === null) {\n        continue;\n      }\n\n      var cellRef = _tempaXlsx2.default.utils.encode_cell({\n        c: C,\n        r: R\n      });\n\n      if (typeof cell.v === 'number') {\n        cell.t = 'n';\n      } else if (typeof cell.v === 'boolean') {\n        cell.t = 'b';\n      } else if (cell.v instanceof Date) {\n        cell.t = 'n';\n        cell.z = _tempaXlsx2.default.SSF._table[14];\n        cell.v = dateToNumber(cell.v);\n      } else {\n        cell.t = 's';\n      }\n\n      ws[cellRef] = cell;\n    }\n  }\n\n  if (range.s.c < 10000000) {\n    ws['!ref'] = _tempaXlsx2.default.utils.encode_range(range);\n  }\n\n  return ws;\n};\n\nexports.strToArrBuffer = strToArrBuffer;\nexports.dateToNumber = dateToNumber;\nexports.excelSheetFromAoA = excelSheetFromAoA;\nexports.excelSheetFromDataSet = excelSheetFromDataSet;","map":{"version":3,"sources":["/Users/maartenvanmeeuwen/Documents/stream-productie/stream-frontend/node_modules/react-data-export/dist/ExcelPlugin/utils/DataUtil.js"],"names":["Object","defineProperty","exports","value","excelSheetFromDataSet","excelSheetFromAoA","dateToNumber","strToArrBuffer","undefined","_typeof","Symbol","iterator","obj","constructor","prototype","_tempaXlsx","require","_tempaXlsx2","_interopRequireDefault","__esModule","default","s","buf","ArrayBuffer","length","view","Uint8Array","i","charCodeAt","v","date1904","epoch","Date","parse","UTC","dataSet","ws","range","c","r","e","rowCount","forEach","dataSetItem","columns","xSteps","ySteps","data","columnsWidth","col","index","cellRef","utils","encode_cell","fixRange","colTitle","push","width","wpx","getHeaderCell","R","C","getCell","encode_range","cell","headerCellStyle","style","font","bold","title","t","isDate","z","SSF","_table"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.excelSheetFromDataSet = exports.excelSheetFromAoA = exports.dateToNumber = exports.strToArrBuffer = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _tempaXlsx = require('tempa-xlsx');\n\nvar _tempaXlsx2 = _interopRequireDefault(_tempaXlsx);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar strToArrBuffer = function strToArrBuffer(s) {\n    var buf = new ArrayBuffer(s.length);\n    var view = new Uint8Array(buf);\n\n    for (var i = 0; i != s.length; ++i) {\n        view[i] = s.charCodeAt(i) & 0xFF;\n    }\n\n    return buf;\n};\n\nvar dateToNumber = function dateToNumber(v, date1904) {\n    if (date1904) {\n        v += 1462;\n    }\n\n    var epoch = Date.parse(v);\n\n    return (epoch - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n};\n\nvar excelSheetFromDataSet = function excelSheetFromDataSet(dataSet) {\n    /*\n    Assuming the structure of dataset\n    {\n        xSteps?: number; //How many cells to skips from left\n        ySteps?: number; //How many rows to skips from last data\n        columns: [array | string]\n        data: [array_of_array | string|boolean|number | CellObject]\n        fill, font, numFmt, alignment, and border\n    }\n     */\n    if (dataSet === undefined || dataSet.length === 0) {\n        return {};\n    }\n\n    var ws = {};\n    var range = { s: { c: 10000000, r: 10000000 }, e: { c: 0, r: 0 } };\n    var rowCount = 0;\n\n    dataSet.forEach(function (dataSetItem) {\n        var columns = dataSetItem.columns;\n        var xSteps = typeof dataSetItem.xSteps === 'number' ? dataSetItem.xSteps : 0;\n        var ySteps = typeof dataSetItem.ySteps === 'number' ? dataSetItem.ySteps : 0;\n        var data = dataSetItem.data;\n        if (dataSet === undefined || dataSet.length === 0) {\n            return;\n        }\n\n        rowCount += ySteps;\n\n        var columnsWidth = [];\n        if (columns.length >= 0) {\n            columns.forEach(function (col, index) {\n                var cellRef = _tempaXlsx2.default.utils.encode_cell({ c: xSteps + index, r: rowCount });\n                fixRange(range, 0, 0, rowCount, xSteps, ySteps);\n                var colTitle = col;\n                if ((typeof col === 'undefined' ? 'undefined' : _typeof(col)) === 'object') {\n                    //colTitle = col.title; //moved to getHeaderCell\n                    columnsWidth.push(col.width || { wpx: 80 }); /* wch (chars), wpx (pixels) - e.g. [{wch:6},{wpx:50}] */\n                }\n                getHeaderCell(colTitle, cellRef, ws);\n            });\n\n            rowCount += 1;\n        }\n\n        if (columnsWidth.length > 0) {\n            ws['!cols'] = columnsWidth;\n        }\n\n        for (var R = 0; R != data.length; ++R, rowCount++) {\n            for (var C = 0; C != data[R].length; ++C) {\n                var cellRef = _tempaXlsx2.default.utils.encode_cell({ c: C + xSteps, r: rowCount });\n                fixRange(range, R, C, rowCount, xSteps, ySteps);\n                getCell(data[R][C], cellRef, ws);\n            }\n        }\n    });\n\n    if (range.s.c < 10000000) {\n        ws['!ref'] = _tempaXlsx2.default.utils.encode_range(range);\n    }\n\n    return ws;\n};\n\nfunction getHeaderCell(v, cellRef, ws) {\n    var cell = {};\n    var headerCellStyle = v.style ? v.style : { font: { bold: true } }; //if style is then use it\n    cell.v = v.title;\n    cell.t = 's';\n    cell.s = headerCellStyle;\n    ws[cellRef] = cell;\n}\n\nfunction getCell(v, cellRef, ws) {\n    //assume v is indeed the value. for other cases (object, date...) it will be overriden.\n    var cell = { v: v };\n    if (v === null) {\n        return;\n    }\n\n    var isDate = v instanceof Date;\n    if (!isDate && (typeof v === 'undefined' ? 'undefined' : _typeof(v)) === 'object') {\n        cell.s = v.style;\n        cell.v = v.value;\n        v = v.value;\n    }\n\n    if (typeof v === 'number') {\n        cell.t = 'n';\n    } else if (typeof v === 'boolean') {\n        cell.t = 'b';\n    } else if (isDate) {\n        cell.t = 'n';\n        cell.z = _tempaXlsx2.default.SSF._table[14];\n        cell.v = dateToNumber(cell.v);\n    } else {\n        cell.t = 's';\n    }\n    ws[cellRef] = cell;\n}\n\nfunction fixRange(range, R, C, rowCount, xSteps, ySteps) {\n    if (range.s.r > R + rowCount) {\n        range.s.r = R + rowCount;\n    }\n\n    if (range.s.c > C + xSteps) {\n        range.s.c = C + xSteps;\n    }\n\n    if (range.e.r < R + rowCount) {\n        range.e.r = R + rowCount;\n    }\n\n    if (range.e.c < C + xSteps) {\n        range.e.c = C + xSteps;\n    }\n}\n\nvar excelSheetFromAoA = function excelSheetFromAoA(data) {\n    var ws = {};\n    var range = { s: { c: 10000000, r: 10000000 }, e: { c: 0, r: 0 } };\n\n    for (var R = 0; R != data.length; ++R) {\n        for (var C = 0; C != data[R].length; ++C) {\n            if (range.s.r > R) {\n                range.s.r = R;\n            }\n\n            if (range.s.c > C) {\n                range.s.c = C;\n            }\n\n            if (range.e.r < R) {\n                range.e.r = R;\n            }\n\n            if (range.e.c < C) {\n                range.e.c = C;\n            }\n\n            var cell = { v: data[R][C] };\n            if (cell.v === null) {\n                continue;\n            }\n\n            var cellRef = _tempaXlsx2.default.utils.encode_cell({ c: C, r: R });\n            if (typeof cell.v === 'number') {\n                cell.t = 'n';\n            } else if (typeof cell.v === 'boolean') {\n                cell.t = 'b';\n            } else if (cell.v instanceof Date) {\n                cell.t = 'n';\n                cell.z = _tempaXlsx2.default.SSF._table[14];\n                cell.v = dateToNumber(cell.v);\n            } else {\n                cell.t = 's';\n            }\n\n            ws[cellRef] = cell;\n        }\n    }\n\n    if (range.s.c < 10000000) {\n        ws['!ref'] = _tempaXlsx2.default.utils.encode_range(range);\n    }\n\n    return ws;\n};\n\nexports.strToArrBuffer = strToArrBuffer;\nexports.dateToNumber = dateToNumber;\nexports.excelSheetFromAoA = excelSheetFromAoA;\nexports.excelSheetFromDataSet = excelSheetFromDataSet;"]},"metadata":{},"sourceType":"script"}