{"ast":null,"code":"import _regeneratorRuntime from\"/Users/maartenvanmeeuwen/Documents/stream-productie/stream-frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/maartenvanmeeuwen/Documents/stream-productie/stream-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React from'react';import{useDropzone}from'react-dropzone';import{List,Typography}from'antd';import Amplify,{Auth,Storage}from'aws-amplify';import awsconfig from'../../aws-exports';Amplify.configure(awsconfig);var Title=Typography.Title;function uuidv4(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=='x'?r:r&0x3|0x8;return v.toString(16);});}var Upload=function Upload(){var auth=Auth;var onDrop=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(acceptedFiles){var authcontext,username,customer;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return auth.currentAuthenticatedUser();case 2:authcontext=_context.sent;username=authcontext.username;console.log(username);customer=authcontext.attributes['custom:customer'];acceptedFiles.forEach(function(file){var uuid=uuidv4();//let filename = username +  \"_\" + customer +  \"_\" + uuid + \".pdf\"\nvar filename=file.name;var reader=new FileReader();reader.onabort=function(){return console.log('file reading was aborted');};reader.onerror=function(){return console.log('file reading has failed');};reader.readAsBinaryString(file);reader.onload=function(){Storage.put(filename,file,{level:'public'}).then(function(){console.log(\"sucessfully saved file!\");}).catch(function(err){console.log('error uploading files!',err);});};});case 7:case\"end\":return _context.stop();}}},_callee);}));return function onDrop(_x){return _ref.apply(this,arguments);};}();var _useDropzone=useDropzone({onDrop:onDrop,accept:\".pdf\"}),getRootProps=_useDropzone.getRootProps,getInputProps=_useDropzone.getInputProps,acceptedFiles=_useDropzone.acceptedFiles,rejectedFiles=_useDropzone.rejectedFiles;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{style:{padding:'20px',backgroundColor:'white',marginTop:'20px'}},/*#__PURE__*/React.createElement(\"div\",getRootProps(),/*#__PURE__*/React.createElement(\"input\",getInputProps()),/*#__PURE__*/React.createElement(Title,{level:3},\"Drop your files here!\"),/*#__PURE__*/React.createElement(List,{size:\"small\",header:/*#__PURE__*/React.createElement(\"div\",null,\"Accepted files:\"),bordered:true,dataSource:acceptedFiles,renderItem:function renderItem(item){return/*#__PURE__*/React.createElement(List.Item,null,\" \",item.path);}}),/*#__PURE__*/React.createElement(List,{size:\"small\",header:/*#__PURE__*/React.createElement(\"div\",null,\"Rejected files:\"),bordered:true,dataSource:rejectedFiles,renderItem:function renderItem(item){return/*#__PURE__*/React.createElement(List.Item,null,\"  \",item.path);}}))));};export default Upload;","map":{"version":3,"sources":["/Users/maartenvanmeeuwen/Documents/stream-productie/stream-frontend/src/Components/Upload/Upload.js"],"names":["React","useDropzone","List","Typography","Amplify","Auth","Storage","awsconfig","configure","Title","uuidv4","replace","c","r","Math","random","v","toString","Upload","auth","onDrop","acceptedFiles","currentAuthenticatedUser","authcontext","username","console","log","customer","attributes","forEach","file","uuid","filename","name","reader","FileReader","onabort","onerror","readAsBinaryString","onload","put","level","then","catch","err","accept","getRootProps","getInputProps","rejectedFiles","padding","backgroundColor","marginTop","item","path"],"mappings":"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","sourcesContent":["import React from 'react';\nimport {useDropzone} from 'react-dropzone';\nimport {List, Typography} from 'antd';\n\n\nimport Amplify, { Auth, Storage } from 'aws-amplify';\n\nimport awsconfig from '../../aws-exports';\nAmplify.configure(awsconfig);\n\nconst { Title } = Typography\n\nfunction uuidv4() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n      var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n      return v.toString(16);    \n    });\n  }\n\n\n\nconst Upload = () => {\n    let auth = Auth;\n\n\n    const onDrop = async(acceptedFiles) => {\n        let authcontext = await auth.currentAuthenticatedUser()\n        let username = authcontext.username\n        console.log(username)\n        let customer = authcontext.attributes['custom:customer']\n        acceptedFiles.forEach((file) => {\n          let uuid = uuidv4()\n          //let filename = username +  \"_\" + customer +  \"_\" + uuid + \".pdf\"\n          let filename = file.name\n          const reader = new FileReader()\n          reader.onabort = () => console.log('file reading was aborted')\n          reader.onerror = () => console.log('file reading has failed')\n          reader.readAsBinaryString(file);\n          reader.onload = () => {\n          \n            Storage.put(filename, file, {\n              level: 'public'\n              })\n              .then(() => {\n                  console.log(\"sucessfully saved file!\")\n              }).catch(err => {\n            console.log('error uploading files!', err)\n          }) \n    \n          }\n        })\n    }\n    const {getRootProps, getInputProps, acceptedFiles, rejectedFiles} = useDropzone({\n        onDrop, \n        accept: \".pdf\"})    \n\n    return <>\n    \n        <div style ={{padding: '20px', \n        backgroundColor: 'white',\n        marginTop: '20px'}}>\n        <div {...getRootProps()}>\n          <input {...getInputProps()} />\n          <Title level = {3}>Drop your files here!</Title>\n          <List\n          size=\"small\"\n          header={<div>Accepted files:</div>}\n          bordered\n          dataSource={acceptedFiles}\n          renderItem={item => <List.Item> {item.path}</List.Item>}\n        />\n             <List\n          size=\"small\"\n          header={<div>Rejected files:</div>}\n          bordered\n          dataSource={rejectedFiles}\n          renderItem={item => <List.Item>  {item.path}</List.Item>}\n        />\n\n        </div>\n        \n        </div>\n    </>\n}   \n\nexport default Upload;"]},"metadata":{},"sourceType":"module"}